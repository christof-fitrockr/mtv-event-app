<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Event Calendar</h2>
    <div>
      <div class="btn-group">
        <div
          class="btn btn-primary"
          (click)="setView(CalendarView.Month)"
          [class.active]="view === CalendarView.Month"
        >
          Month
        </div>
        <div
          class="btn btn-primary"
          (click)="setView(CalendarView.Week)"
          [class.active]="view === CalendarView.Week"
        >
          Week
        </div>
        <div
          class="btn btn-primary"
          (click)="setView(CalendarView.Day)"
          [class.active]="view === CalendarView.Day"
        >
          Day
        </div>
        <div
          class="btn btn-primary"
          (click)="setView('table')"
          [class.active]="view === 'table'"
        >
          Table
        </div>
      </div>
    </div>
  </div>

  <div [ngSwitch]="view">
    <mwl-calendar-month-view
      *ngSwitchCase="CalendarView.Month"
      [viewDate]="viewDate"
      [events]="events"
      (eventClicked)="handleEvent('Clicked', $event.event)"
    >
    </mwl-calendar-month-view>
    <mwl-calendar-week-view
      *ngSwitchCase="CalendarView.Week"
      [viewDate]="viewDate"
      [events]="events"
      (eventClicked)="handleEvent('Clicked', $event.event)"
      [hourSegments]="2"
      [dayStartHour]="0"
      [dayEndHour]="23"
    >
    </mwl-calendar-week-view>
    <mwl-calendar-day-view
      *ngSwitchCase="CalendarView.Day"
      [viewDate]="viewDate"
      [events]="events"
      (eventClicked)="handleEvent('Clicked', $event.event)"
      [hourSegments]="2"
      [dayStartHour]="0"
      [dayEndHour]="23"
    >
    </mwl-calendar-day-view>
    <div *ngSwitchCase="'table'">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Date</th>
            <th>Time</th>
            <th>Event</th>
            <th>Coaches</th>
            <th>Location</th>
            <th>Occupation</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let event of events" (click)="handleEvent('Clicked', event)">
            <td>{{ event.start | date:'fullDate' }}</td>
            <td>{{ event.start | date:'shortTime' }} - {{ event.end | date:'shortTime' }}</td>
            <td>{{ event.title }}</td>
            <td>
              <span *ngFor="let coach of event.coaches; let last = last">
                {{ coach.name }}{{ !last ? ', ' : '' }}
              </span>
            </td>
            <td>{{ event.location.name }}</td>
            <td>{{ event.occupation }} / {{ event.maxParticipants }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<app-event-details
  *ngIf="selectedEvent"
  [event]="selectedEvent"
  (closeModal)="closeModal()"
></app-event-details>
